#include "parser.h"

namespace Parser {
<<<<<<< HEAD
=======


>>>>>>> dc45e7c46656daf7b2166739aeb7d3ce3bff442b
	Scene* parseObjFile(const char* filename) {
		std::vector<Object*> sceneObjects;
		Object* currObj = 0;
		std::vector<Vertex*> vertices;

		std::cout << filename;
		std::ifstream input(filename);

		if (!input) { // file does not exist
			throw "file does not exist";
		}

		for (std::string line; getline(input, line); ) {
			std::stringstream ss(line);
			std::string item;

			getline(ss, item, ' ');

			if (item == "o") { // start of a new object
				if (currObj) { // if it's not the first object parsed
					sceneObjects.push_back(currObj); // add old object to list
				}

				currObj = new Object;
			} else if (item == "v") { // vertex
				float coords[3];

				for (int i = 0; getline(ss, item, ' '); i++) {
					coords[i] = atof(item.c_str());
				}

				Vertex* newVertex = new Vertex(coords);

				vertices.push_back(newVertex);

			} else if (item == "f") { // face
				int firstVertexIndex, lastVertexIndex;

				for (int i = 0; getline(ss, item, ' '); i++) {
					int vertexIndex = atoi(item.c_str());
<<<<<<< HEAD
=======
					std::cout << "is a face" << std::endl;
>>>>>>> dc45e7c46656daf7b2166739aeb7d3ce3bff442b
					if (i == 0) {
						firstVertexIndex = vertexIndex;
					} else if (i >= 2) {
						Face* f = new Face;
						f->addVertex(vertices[firstVertexIndex - 1]);
						f->addVertex(vertices[lastVertexIndex - 1]);
						f->addVertex(vertices[vertexIndex - 1]);

<<<<<<< HEAD
=======
						std::cout << *f;
>>>>>>> dc45e7c46656daf7b2166739aeb7d3ce3bff442b
						currObj->addFace(f);
					}
					lastVertexIndex = vertexIndex;
				}
<<<<<<< HEAD
=======
				/*
				Face* f = new Face;

				while (getline(ss, item, ' ')) {
					int index = atoi(item.c_str());
					f->addVertex(vertices[index]);
				}

				currObj->addFace(f);
				*/
>>>>>>> dc45e7c46656daf7b2166739aeb7d3ce3bff442b
			}
		} 

		sceneObjects.push_back(currObj); // add the last object to the list
		Scene* s = new Scene(sceneObjects);
		return s;
	}

<<<<<<< HEAD
	Material* parseMtlFile(const char* filename) {
=======
	void parseMtlFile(const char* filename) {
>>>>>>> dc45e7c46656daf7b2166739aeb7d3ce3bff442b
		std::ifstream input(filename);

		if (!input) { // file does not exist
			throw "file does not exist";
		}
	}
<<<<<<< HEAD
};
=======
};
>>>>>>> dc45e7c46656daf7b2166739aeb7d3ce3bff442b
